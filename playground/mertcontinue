#!/bin/bash
# simple script to continue a mert experiment that failed

function die() {
  echo "$@" >&2
  exit 1
}
set -o pipefail

[ ! -z "$1" ] || die "usage: $0 exp-identifier"

e=`eman guess $1`

[ -d $e ] || die "Not an experiment: $e";

perl -i~ -pe 's/^(.*(clone_moses|absolutize_moses))/# $1/; s/(mert-moses.pl)/$1 --continue/;' $e/eman.command \
|| die "Failed to modify eman.command"

rm -rf $e/mert-tuning/filtered

echo "Now check $e/eman.command and start it over:"
echo "  eman continue $e"


